<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mes Commandes - FortniteItems</title>
    
    <link rel="icon" type="image/png" href="assets/favicnon.png">
    <link rel="apple-touch-icon" href="assets/favicnon.png">
    
    <link rel="stylesheet" href="styles.css?v=2.5">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Orbitron:wght@400;700;900&family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <!-- Navigation -->
    <div id="navbar-container"></div>
    <script src="js/navbar-loader.js"></script>

    <!-- Orders History -->
    <main class="orders-page page-padding">
        <div class="container">
            <div class="section-header">
                <h1 class="section-title">üì¶ Mes Commandes</h1>
                <p class="section-subtitle">Suis l'√©tat de tes commandes et donne ton avis</p>
            </div>

            <div id="ordersList" class="orders-list">
                <!-- Les commandes seront inject√©es ici par JavaScript -->
            </div>

            <!-- Styles sp√©cifiques pour le suivi live -->
            <style>
                .order-card {
                    background: rgba(13, 12, 24, 0.85); /* Plus sombre/profond */
                    backdrop-filter: blur(16px);
                    border: 1px solid rgba(255, 255, 255, 0.08);
                    border-left: 4px solid var(--electric-blue); /* Accent sur le c√¥t√© */
                    border-radius: 12px;
                    padding: 0;
                    margin: 0 auto 1.5rem auto; /* Centered */
                    max-width: 650px; /* Highly Constrained width */
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                    position: relative;
                }

                .order-card:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 15px 40px rgba(0, 212, 255, 0.1);
                    border-color: rgba(255, 255, 255, 0.2);
                }

                .order-header-live {
                    padding: 1rem 1.5rem; /* Reduced padding */
                    background: linear-gradient(90deg, rgba(255,255,255,0.03) 0%, transparent 100%);
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                }

                .order-id-title {
                    font-family: 'Orbitron', sans-serif;
                    font-size: 1rem; /* Smaller title */
                    color: white;
                    letter-spacing: 1px;
                    margin: 0 0 5px 0;
                }

                .order-date-sub {
                    font-family: 'Rajdhani', sans-serif;
                    font-size: 0.85rem;
                    color: rgba(255, 255, 255, 0.5);
                }

                .order-amount-display {
                    font-family: 'Orbitron', sans-serif;
                    font-size: 1.2rem; /* Smaller amount */
                    font-weight: 700;
                    color: var(--electric-blue);
                    text-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
                }

                /* STATUS CARDS REDESIGN (Compact V2) */
                .order-status-track {
                    padding: 0.8rem 1rem;
                    display: grid;
                    grid-template-columns: repeat(3, 1fr);
                    gap: 8px;
                    max-width: 100%; /* Fill container now that container is small */
                    margin: 0 auto;
                }

                .status-step {
                    background: rgba(255, 255, 255, 0.03);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 8px; /* Smaller radius */
                    padding: 10px;      /* Reduced padding */
                    display: flex;
                    align-items: center;
                    transition: all 0.3s ease;
                    opacity: 0.5;
                    filter: grayscale(1);
                    position: relative;
                    overflow: hidden;
                }

                .status-step.active {
                    opacity: 1;
                    filter: grayscale(0);
                    background: rgba(13, 12, 24, 0.9);
                    border-color: var(--electric-blue);
                    box-shadow: 0 0 15px rgba(0, 212, 255, 0.2), inset 0 0 5px rgba(0, 212, 255, 0.1); /* Reduced glow */
                    transform: translateY(-1px);
                }
                
                .status-step.completed {
                    opacity: 1;
                    filter: grayscale(0);
                    border-color: #00ff88;
                    color: #00ff88;
                }

                .step-icon {
                    font-size: 1.2rem;   /* Smaller icon */
                    margin-right: 10px;  /* Smaller margin */
                    width: 36px;         /* Smaller box */
                    height: 36px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    background: rgba(255, 255, 255, 0.05);
                    border-radius: 6px;
                }
                
                .status-step.active .step-icon {
                    background: rgba(0, 212, 255, 0.2);
                    box-shadow: 0 0 8px rgba(0, 212, 255, 0.4);
                    animation: pulse-icon 2s infinite;
                }

                .step-info {
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    min-width: 0; /* Fix flex overflow */
                }

                .step-label {
                    font-family: 'Rajdhani', sans-serif;
                    font-weight: 700;
                    font-size: 0.9rem; /* Smaller text */
                    text-transform: uppercase;
                    line-height: 1.1;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .step-desc {
                    font-size: 0.7rem; /* Smaller subtext */
                    opacity: 0.6;
                    font-family: sans-serif;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }
                
                @keyframes pulse-icon {
                    0% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                    100% { transform: scale(1); }
                }

                /* Mobile: Ultra-Compact Stack */
                @media (max-width: 768px) {
                    .order-card {
                        margin: 0 1rem 1rem 1rem; /* Less margin on sides */
                        width: auto;
                    }

                    .order-header-live { 
                        padding: 0.8rem 1rem; /* Compact header */
                    }
                    
                    .order-id-title { font-size: 0.9rem; margin-bottom: 2px; }
                    .order-date-sub { font-size: 0.75rem; }
                    .order-amount-display { font-size: 1rem; }

                    .order-status-track {
                        grid-template-columns: 1fr; 
                        gap: 5px; /* Tiny gap */
                        padding: 0.8rem 1rem;
                        max-width: 100%;
                    }
                    
                    .status-step {
                        padding: 6px 10px; /* Very compact */
                        border-radius: 6px;
                    }
                    
                    .step-icon {
                        width: 28px; height: 28px; font-size: 0.9rem; /* Tiny icon */
                        margin-right: 8px;
                        border-radius: 5px;
                    }
                    
                    .step-label { font-size: 0.8rem; }
                    .step-desc { display: none; }
                    
                    .order-details-live, .live-actions {
                        padding: 0.8rem 1rem; /* Compact content */
                    }
                    
                    .item-icon { width: 32px; height: 32px; font-size: 1rem; }
                }

                /* --- RESTORED SECTIONS (Was deleted by mistake) --- */

                .order-details-live {
                    padding: 1.5rem 2rem;
                    background: rgba(0, 0, 0, 0.2);
                    border-top: 1px solid rgba(255, 255, 255, 0.05);
                }
                
                .item-row {
                    display: flex;
                    align-items: center;
                    padding: 0.8rem 0;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
                }
                
                .item-row:last-child { border-bottom: none; }

                .item-icon {
                    width: 40px;
                    height: 40px;
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 8px;
                    margin-right: 15px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.2rem;
                }

                .live-actions {
                    padding: 1.5rem 2rem;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    background: rgba(0,0,0,0.1);
                }

                .status-text-live {
                    font-family: 'Rajdhani', sans-serif;
                    color: var(--electric-blue);
                    font-weight: 600;
                }
            </style>
            
            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    const token = localStorage.getItem('auth_token');
                    if (!token) {
                        document.getElementById('ordersList').style.display = 'none';
                        document.getElementById('emptyOrders').style.display = 'none'; // Hide default empty
                        
                        const container = document.querySelector('.container');
                        const loginPrompt = document.createElement('div');
                        loginPrompt.className = 'empty-state';
                        loginPrompt.style.textAlign = 'center';
                        loginPrompt.style.padding = '4rem 2rem';
                        loginPrompt.innerHTML = `
                            <div style="font-size: 4rem; margin-bottom: 1rem;">üîí</div>
                            <h2 style="margin-bottom: 1rem;">Connexion requise</h2>
                            <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 2rem;">
                                Connectez-vous pour voir l'historique de vos commandes.
                            </p>
                            <div style="display: flex; gap: 1rem; justify-content: center;">
                                <a href="login.html" class="cta-button">
                                    <span>Se Connecter</span>
                                </a>
                                <a href="login.html?mode=register" class="ghost-button">
                                    Cr√©er un compte
                                </a>
                            </div>
                        `;
                        container.appendChild(loginPrompt);
                        
                        // Stop orders.js from doing anything (hacky but works if script loads after)
                        window.stopOrdersLoad = true;
                    }
                });
            </script>

            <div id="emptyOrders" class="empty-state" style="text-align: center; padding: 4rem 2rem; display: none;">
                <div style="font-size: 4rem; margin-bottom: 1rem;">üì≠</div>
                <h2 style="margin-bottom: 1rem;">Aucune commande</h2>
                <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 2rem;">
                    Tu n'as pas encore pass√© de commande. Parcours notre boutique pour trouver ce qui te pla√Æt !
                </p>
                <a href="shop.html" class="cta-button">
                    <span>üõçÔ∏è Voir la boutique</span>
                </a>
            </div>
        </div>
    </main>

    <!-- Review Modal -->
    <div id="reviewModal" class="shop-order-modal" aria-hidden="true" style="display: none;">
        <div class="shop-order-dialog" role="dialog" aria-modal="true" style="max-width: 500px;">
            <button type="button" class="modal-close" id="reviewModalClose" aria-label="Fermer">&times;</button>
            <p class="modal-eyebrow">Donner ton avis</p>
            <h3 id="reviewOrderName">Commande #FN123</h3>
            
            <div class="modal-field">
                <label>Note (sur 5 √©toiles)</label>
                <div class="rating-input" style="display: flex; gap: 0.5rem; justify-content: center; margin: 1rem 0;">
                    <button type="button" class="star-btn" data-rating="1">‚≠ê</button>
                    <button type="button" class="star-btn" data-rating="2">‚≠ê</button>
                    <button type="button" class="star-btn" data-rating="3">‚≠ê</button>
                    <button type="button" class="star-btn" data-rating="4">‚≠ê</button>
                    <button type="button" class="star-btn" data-rating="5">‚≠ê</button>
                </div>
                <input type="hidden" id="reviewRating" value="0">
            </div>
            
            <div class="modal-field">
                <label for="reviewComment">Ton avis (optionnel)</label>
                <textarea id="reviewComment" rows="4" placeholder="Partage ton exp√©rience avec notre service..."></textarea>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="ghost-button" id="reviewCancelBtn">Annuler</button>
                <button type="button" class="cta-button" id="reviewSubmitBtn">
                    <span>Envoyer l'avis</span>
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="orders.js"></script>
</body>
</html>

